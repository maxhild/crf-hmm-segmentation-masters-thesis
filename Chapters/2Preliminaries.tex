%*****************************************
\chapter{Grundlagen}\label{ch:preliminaries}
%*****************************************

In diesem Kapitel werden die medizinischen und technischen Grundlagen erläutert, die für das Verständnis der Arbeit notwendig sind.
Dabei wird zuerst auf die medizinischen Hintergründe des behandelten Problems eingegangen.
Anschließend werden das technische Fundament der aktuellen Segmentierung sowie gängige Bildgebungsverfahren erläutert, die zur Lösung des Problems eingesetzt werden können.
Die verwendeten mathematischen Hintergründe und Theoreme werden ebenfalls in diesem Kapitel vorgestellt, um die theoretische Basis der Arbeit zu untermauern.

\section{Medizinischer Hintergrund}
Endoskopie ist eine der zentralen Behandlungs- und Diagnosemöglichkeiten in der Therapie von Darmkrebs, 
einer der häufigsten und tödlichsten Krebsarten.\citep{labianca2010-colon-cancer}\footnotemark{} 
Nicht von der Hand zu weisen ist hierbei die zeitaufwändige Durchführung und 
Dokumentation der Überwachung des flächigen Gewebes im Darm im Rahmen von Endoskopien. Aus diesem Grund ist es 
der Gastroenterologie konstant ein Anliegen, die Qualitätssicherung bei Darmspiegelungen zu verbessern. 
Wie in der Einleitung erwähnt, ist die Zökum-Rückzugszeit ein Beispiel für ein zuverlässiges Qualitätsmerkmal.  Hierbei ist es wichtig, dass die Darmspiegelung eine vorgeschriebene Zeit dauert, um die Chance auf eine vollständige Detektion aller möglichen Adenome zu erhöhen. 
Dadurch steigt die Wahrscheinlichkeit, dass die Darmspiegelung sorgfältig durchgeführt wurde, was nachweislich zu einer 
erhöhten Anzahl frührer Diagnosen führt und somit Todesfälle verhindern kann. Das liegt daran, dass die Durchführung von Darmspiegelungen sorgfältiger wird, wenn 
die Zeitvorgaben eingehalten werden.
Dieses Beispiel zeigt, dass wenn Qualitätskriterien eingehalten werden die Behandlungsqualität steigen kann. 
Die Europäische Gesellschaft für Gastroenterologie (ESGE) hat hierzu einige Forschungsfragen herausgegeben. Hierbei gibt es einige Punkte, speziell während der Endoskopie sowie in der Nachbereitung des Videomaterials, als auch weitergehend deren Umsetzung durch Nutzung eines KI-gestützten Systems zur Qualitätssicherung bei Darmspiegelungen profitieren könnten:

\begin{enumerate}
  \item \textbf{Vorbereitung der Prozedur}
    \begin{itemize}
      \item Welche Art von Intervention verbessert die Rate einer adäquaten Darmvorbereitung?
      \item Wie viel Zeit sollte für Screening- und diagnostische Koloskopien eingeplant werden?
    \end{itemize}

  \item \textbf{Vollständigkeit der Prozedur}
    \begin{itemize}
      \item Wie verhalten sich diagnostische Ausbeute (und Intervallkarzinomrate) in Abhängigkeit von einer steigenden Zökumintubationsrate?
      \item Welchen Nutzen hat die Dokumentation der Zökumintubation nur im schriftlichen Bericht im Vergleich zu einem schriftlichen \emph{und} fotografischen Bericht?
    \end{itemize}

  \item \textbf{Identifikation von Pathologien}
    \begin{itemize}
      \item Welcher Zielwert gilt für die Adenomdetektionsrate?
      \item Welches Leistungsmaß spiegelt die Identifikation von Pathologien außerhalb des CRC-Screening-/Überwachungssettings wider?
    \end{itemize}

  \item \textbf{Management von Pathologien}
    \begin{itemize}
      \item Was ist die verlässlichste und praktikabelste Methode, um die Vollständigkeit der Polypentfernung zu messen?
      \item Wie wirksam sind Zusatztechniken/-skalen (Chromendoskopie, Paris-Klassifikation, Tätowierung von Resektionsstellen) im Management von Pathologien?
    \end{itemize}

  \item \textbf{Komplikationen}
    \begin{itemize}
      \item Was ist die verlässlichste und praktikabelste Methode, um Komplikationsraten zu überwachen?
      \item Trägt die Überwachung dazu bei, Komplikationsraten zu senken?
    \end{itemize}
\end{enumerate}
\citep{kaminski-performance-2017}

Eine der Motivationen für ein zuverlässiges Segmentationsmodell für Endoskopievideos ist es, 
dass die Zökum-Rückzugszeit automatisch berechnet werden könnte. Wenn anhand der outside prediction der letzte Frame, 
der innerhalb des Körpers gefunden wird, festgestellt ist, ist die untere Schranke für den der Berechnung zugrundeliegenden Abschnitt des 
Videos bereits gegeben. Für die Berechnung der Zäkum-Rückzugszeit würde sich das so errechnete Upper Bound bei den Frames in dem Moment eignen, 
in dem auch das Zäkum vertrauenswürdig erkannt wird. Die zuverlässige Erkennung von Organteilen des Darms im Video ist 
Teil der endoskopischen Forschung mit künstlicher Intelligenz. Im speziellen die Erkennung von Polypen ist von besonderem Interesse. 
Diese Geschwulste wachsen als Vorstufe von potenziell bösartigen Tumoren an der Darminnenwand. Sie können aus verschiedenen Gründen und in verschiedenen Darmteilen auftreten, 
sind jedoch besonders als Frühmerkmal einer möglichen Diagnose von Darmkrebs interessant und deshalb wenn möglich vollständig zu erkennen. \citep{doi:10.7326/0003-4819-157-4-201208210-00002}
Weiter kompliziert wird die Erkennung und Einschätzung von Polypen dadurch, dass es verschiedene Stufen gibt.
Während bei einigen kolorektalen Polypen eine Darmblutung als Symptom auftritt, die zumeist eine schnelle Diagnose ermöglicht, sind andere Polypen asymptomatisch und werden nur zufällig bei einer routinemäßigen Darmspiegelung entdeckt.
Besonders bei diesen Fällen kann das Risiko bestehen, dass Polypen übersehen werden.
Unterschieden wird hierbei zwischen hochgradigen und niedergradigen Dysplasien. Diese Stufen bezeichnen den Grad der Zellveränderung in der Region des Polypen.
Besonders bei höhergradigen Dysplasien besteht das Risiko, dass ein maligner Polyp vorliegt.
Definitiv kann dies durch den Nachweis karzinogener Zellen innerhalb eines Polypen festgestellt werden. Hierbei handelt es sich um eine Aufgabe für die Pathologie,
die nach vollständiger Entfernung des betroffenen Gewebes erfolgen kann. \citep{Colucci261}
Auch bei der Zökum-Rückzugszeit ist das zentrale Kriterium, dass möglichst wenige Polypen übersehen werden sollen. 
Da durch den Einsatz von automatischer Erkennung dieser Vorkommnisse innerhalb des Darms eine erhebliche Beschleunigung dieses 
Prozesses möglich wäre, wird in diesem Bereich bereits seit Jahren geforscht. \citep{talukder-2022} 

Die Inferenz mit CNN basierten Modellen wie ResNet50 oder EfficientNetB0 hat sich in den letzten Jahren als sehr erfolgreich erwiesen.
Diese Modelle sind in der Lage, Bilddaten zu klassifizieren und können auch für die Segmentierung von Videos als Frames genutzt werden.
Die Ergebnisse dieser Klassifikation sind bei ausreichendem Training in einer kontinuierlichen Pipeline nutzbar.

\section{Technische und mathematische Grundlagen}

Dieses Kapitel wird die Herangehensweise an die mathematische Modellierung der Segmentierung von Endoskopievideos erläutern.
In diesem Kontext soll später im Kapitel Methodik herausgearbeitet werden, welche Modelle sich für eine statistisch haltbare Bewertung von Frameregionen eignen.

\subsubsection{Markov-Prozesse}

\enquote{Wir betrachten ein zufälliges dynamisches System. Sei $S : \mathbb{R} \to \mathbb{R}$ ein dynamisches System und definieren einen stochastischen Prozess $\{X_n\}_{n \ge 0}$ durch $X_{n+1} = S(X_n) + Y_n$, wobei $Y_0, Y_1, \dots$ unabhängige Zufallsvariablen mit Werten in $\mathbb{R}$ sind, die jeweils die gleiche Dichte $g$ haben, und $X_0$ und $\{Y_n\}_{n \ge 0}$ unabhängig sind. Dann ist der stochastische Prozess $\{X_n\}$ ein Markov-Prozess.} \citep[S.~13]{KhalilGhaffari2023}
Markov Prozesse sind laut dieser Definition Systeme aus Zuständen, die sich über die Zeit verändern.
Sie dürfen dabei nur von dem aktuellen Zustand abhängen und nicht von den vorherigen Zuständen.
Die Definition bezieht sich auf ein Stochastisches System und sieht deshalb eine Normierung der Werte im Bereich 0 bis 1 vor.
Die Zustände des Systems werden durch die Zufallsvariablen $X_n$ beschrieben.
\newline
Der Name der Markov-Prozesse stammt aus der Arbeit von A. A. Markov \citep{markov1906extension}.
Das erste Paper von Markov behandelt, inwiefern das schwache Gesetz der großen Zahlen auch auf einfach abhängige
Variablen anwendbar ist. Diese Idee wurde weiterentwickelt, um durch passende Modelle effiziente Vorhersagen über zukünftige Ereignisse treffen zu können.
Seine Arbeit hat bis heute großen Einfluss und findet sich auch in aktuellen Entwicklungen wie Recurrent Neural Networks wieder.

$$
\sum{X}
$$

\subsection{Sequenzielle Datenmodellierung}

Die Modellierung sequenzieller Daten ist ein wichtiger Aspekt in vielen Bereichen der Informatik und Statistik, insbesondere in der Verarbeitung natürlicher Sprache, Zeitreihenanalyse und Bioinformatik. Sequenzielle Daten bestehen aus einer geordneten Folge von Elementen, bei denen die Reihenfolge der Elemente eine entscheidende Rolle spielt. Beispiele für sequenzielle Daten sind Textdokumente, DNA-Sequenzen und Zeitreihen von Messwerten.
\newline
Im Kontext von Markov-Prozessen und Hidden Markov Models (HMM) ist die Modellierung sequenzieller Daten besonders relevant, da diese Modelle darauf abzielen, die Abhängigkeiten zwischen aufeinanderfolgenden Zuständen in einer Sequenz zu erfassen.
\newline
Wir haben die 1-Schritt-Übergangsmatrix $P$.
Per Definition:

$$
(P)_{ij} = P(X_{t+1} = j \mid X_t = i)
$$

Wenn 

$$
P(X_{t+2} = j \mid X_t = i)
$$

Um dort hin zu gelangen, müssen wir durch einen Zwischenzustand $k$ gehen:
$$
P(X_{t+2} = j \mid X_t = i) = \sum_k P(X_{t+1} = k \mid X_t = i)\; P(X_{t+2} = j \mid X_{t+1} = k)
$$

\newline
Die Übergangswahrscheinlichkeiten können in einer Matrix $P$ zusammengefasst werden,
wobei die Einträge $P_{ij}$ die Wahrscheinlichkeit angeben, vom Zustand $i$ in den Zustand $j$ überzugehen.
Die Matrix $P$ wird als Übergangsmatrix bezeichnet und hat die Eigenschaft, dass die Summe der Einträge in jeder Zeile gleich 1 ist, da sie die gesamten Übergangswahrscheinlichkeiten von einem Zustand zu allen möglichen Zuständen repräsentiert.
\newline


In der Definition nimmt das Modell ein vollständig abgebildetes stochastisches Zufallsexperiment an.
Es wird zudem davon ausgegangen, dass die Zustände des Systems vollständig beobachtbar sind.
Einer einfachen Definition folgend, muss für jedes Label $y_i$ eines Frames $x_i$ die Wahrscheinlichkeit $P(y_i|x_i)$ modelliert werden.

\subsection{Markov Ketten}

Markov Modelle basieren auf der Erweiterung des schwachen Gesetzes der großen Zahlen sowie des Theorems der 

\subsection{Markov Modelle}

Markov Modelle sind eine Klasse von statistischen Modellen, die verwendet werden, um Systeme zu modellieren, die sich über die Zeit verändern. Sie basieren auf der Annahme, dass der zukünftige Zustand eines Systems nur vom aktuellen Zustand abhängt und nicht von den vorherigen Zuständen. Dies wird als Markov-Eigenschaft bezeichnet.
Die Modelle werden als \enquote{Hidden} bezeichnet, da die zugrunde liegenden Zustände nicht direkt beobachtet werden können, sondern nur durch beobachtbare Ausgaben oder Emissionen inferiert werden.
\newline
HMM sind eine 
Generell handelt es sich bei HMM um ein generatives Modell, es wird also eine Wahrscheinlichkeit basierend auf dem zugrundeliegenden gelernten System abgebildet.
$P(X, Y)$


\subsection{Conditional Random Fields als generalisiertes Markov-Modell}

Conditional Random Fields (CRF) beschreiben eine Klasse von Modellen, mit denen sich Übergangswahrscheinlichkeiten darstellen lassen. Generell handelt es sich bei CRF um ein diskriminatives Modell, es wird also direkt die bedingte Wahrscheinlichkeit $P(Y|X)$ der Ausgabevariablen $Y$ gegeben die Eingabevariablen $X$ modelliert, anstatt der gemeinsamen Wahrscheinlichkeit $P(X, Y)$.
Diese Modellklasse ist die generalisierte Form von Markov Models. Hidden Markov Models beschreiben, wie im Kapitel erläutert, die Annahme, dass aufgrund von dem vorherigen versteckten Zustand das System vorhergesagt werden kann. Hierfür müsste jedoch das System von der Menge der versteckten Zustände vollständig beobachtbar sowie abbildbar sein.

\subsection{Non Markov Modelle}



\subsection{Chapman--Kolmogorov-Gleichung}

Die Chapman--Kolmogorov-Gleichung beschreibt, wie die Übergangswahrscheinlichkeit eines Markov-Prozesses über mehrere Zeitschritte hinweg berechnet werden kann. 
Dabei wird ein möglicher Zwischenzustand $k$ zu einem Zeitpunkt $m$ berücksichtigt, sodass die Wahrscheinlichkeit für einen Übergang von Zustand $i$ zu Zustand $j$ nach $n+m$ Schritten über die Gesamtheit aller Zwischenzustände dargestellt werden kann.

Formell gilt für $i, j \in S$ und $n, m \geq 0$:
\begin{equation}
P(X_{n+m} = j \mid X_0 = i) \;=\; \sum_{k \in S} P(X_{n+m} = j \mid X_m = k, X_0 = i)\; P(X_m = k \mid X_0 = i).
\end{equation}

Mit Hilfe der Markov-Eigenschaft vereinfacht sich der erste Term, da der zukünftige Zustand $X_{n+m}$ nur vom aktuellen Zustand $X_m$ abhängt, nicht aber vom gesamten Verlauf bis $X_0 = i$:
\begin{equation}
P(X_{n+m} = j \mid X_m = k, X_0 = i) \;=\; P(X_{n+m} = j \mid X_m = k).
\end{equation}

Damit ergibt sich die Chapman--Kolmogorov-Gleichung in der üblichen Form:
\begin{equation}
P(X_{n+m} = j \mid X_0 = i) \;=\; \sum_{k \in S} P(X_{n+m} = j \mid X_m = k)\, P(X_m = k \mid X_0 = i).
\end{equation}

Schreibt man die Übergangswahrscheinlichkeiten in Matrixform, so entspricht dies der Aussage:
\begin{equation}
P^{(n+m)} \;=\; P^{(m)} \cdot P^{(n)},
\end{equation}
wobei $P^{(r)}$ die $r$-Schritt-Übergangsmatrix bezeichnet.


\begin{definition}[Beispieldefinition]
Dies ist eine Beispieldefinition.
\end{definition}
